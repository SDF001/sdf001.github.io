import{o as p,i as z}from"./lifecycle.BlrLGdja.js";import{c as C,f as I,a as u,p as q,b as H,s as v,g as n,m,i as x,u as M,d as B,e as T,r as V,t as j,a0 as _}from"./template.0_meXfg9.js";import{e as F}from"./utils.B_2nTLBL.js";import{i as y}from"./if.TGPNFcNE.js";import{p as W,a as A,s as D}from"./props.CGuG6kVv.js";import{s as h}from"./config.BBlUlAjb.js";/* empty css                        */var G=_('<svg class="w-5 h-5 icon-transition svelte-8vwu4q" fill="currentColor" viewBox="0 0 24 24"><path d="M4 6h16v2H4zm0 5h16v2H4zm0 5h16v2H4z" class="svelte-8vwu4q"></path></svg>'),J=_('<svg class="w-5 h-5 icon-transition svelte-8vwu4q" fill="currentColor" viewBox="0 0 24 24"><path d="M3 3h7v7H3V3zm0 11h7v7H3v-7zm11-11h7v7h-7V3zm0 11h7v7h-7v-7z" class="svelte-8vwu4q"></path></svg>'),K=B('<button aria-label="切换文章列表布局"><!></button>');function Y(b,g){H(g,!1);let s=W(g,"currentLayout",12,"list"),l=m(!1),i=m(!1),r=m(!1);function d(){v(i,window.innerWidth<1200),n(i)&&s("list")}p(()=>{v(l,!0),d();const e=localStorage.getItem("postListLayout");return e&&(e==="list"||e==="grid")&&s(e),window.addEventListener("resize",d),()=>{window.removeEventListener("resize",d)}});function S(){if(!n(l)||n(i)||n(r))return;v(r,!0),s(s()==="list"?"grid":"list"),localStorage.setItem("postListLayout",s());const e=new CustomEvent("layoutChange",{detail:{layout:s()}});window.dispatchEvent(e),setTimeout(()=>{v(r,!1)},500)}p(()=>{const e=t=>{s(t.detail.layout)};return window.addEventListener("layoutChange",e),()=>{window.removeEventListener("layoutChange",e)}}),p(()=>{const e=o=>{s(o.detail.layout)},t=()=>{setTimeout(()=>{console.log("Swup event - syncing layout state");const o=localStorage.getItem("postListLayout");if(o&&(o==="list"||o==="grid"))s(o);else{const w=h.postListLayout.defaultMode;s(w)}},200)};window.addEventListener("layoutInit",e);function c(){if(typeof window<"u"&&window.swup){const o=window.swup;o.hooks.on("content:replace",t),o.hooks.on("page:view",t),o.hooks.on("animation:in:end",t),console.log("Swup button listeners registered")}else window.addEventListener("popstate",t),console.log("Fallback button listeners registered")}return setTimeout(c,200),()=>{if(window.removeEventListener("layoutInit",e),typeof window<"u"&&window.swup){const o=window.swup;o.hooks.off("content:replace",t),o.hooks.off("page:view",t),o.hooks.off("animation:in:end",t)}else window.removeEventListener("popstate",t)}}),z();var L=C(),E=I(L);{var k=e=>{var t=K(),c=T(t);{var o=a=>{var f=G();u(a,f)},w=a=>{var f=J();u(a,f)};y(c,a=>{s()==="list"?a(o):a(w,!1)})}V(t),j(()=>{A(t,1,`btn-plain scale-animation rounded-lg h-11 w-11 active:scale-90 flex items-center justify-center theme-switch-btn ${n(r)?"switching":""}`,"svelte-8vwu4q"),t.disabled=n(r),D(t,"title",s()==="list"?"切换到网格模式":"切换到列表模式")}),F("click",t,S),u(e,t)};y(E,e=>{n(l),x(h),n(i),M(()=>n(l)&&h.postListLayout.allowSwitch&&!n(i))&&e(k)})}u(b,L),q()}export{Y as default};
