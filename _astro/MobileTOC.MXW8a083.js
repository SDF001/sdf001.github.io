import{o as ht,i as bt}from"./lifecycle.BlrLGdja.js";import{d as p,f as B,t as C,a as m,p as wt,b as gt,g as o,m as E,e as d,s as g,h as _,r as l,c as F,n as _t}from"./template.0_meXfg9.js";import{s as P}from"./render.9aRxkNX-.js";import{i as x}from"./if.TGPNFcNE.js";import{e as G,i as J}from"./each.CjCacZm2.js";import{e as A}from"./utils.B_2nTLBL.js";import{a as xt}from"./props.CGuG6kVv.js";import{I as L}from"./Icon.CbWJOKR2.js";import{I as Q}from"./zh_TW.uCNb5urF.js";import{i as U}from"./translation.CeEif7BC.js";import{n as yt}from"./navigation-utils.Cc6bKnia.js";import{panelManager as W}from"./panel-manager.EIcTVdBl.js";/* empty css                        */import"./config.BBlUlAjb.js";var It=p('<div class="text-center py-8 text-black/50 dark:text-white/50"><!> <p>暂无文章</p></div>'),kt=p('<div class="post-category svelte-cz3h3s"> </div>'),Tt=p('<button class="post-item svelte-cz3h3s"><div class="post-title svelte-cz3h3s"><!> </div> <!></button>'),Ct=p('<div class="post-content svelte-cz3h3s"></div>'),Et=p('<div class="text-center py-8 text-black/50 dark:text-white/50"><p>当前页面没有目录</p></div>'),Pt=p('<button><span class="toc-text svelte-cz3h3s"> </span></button>'),At=p('<div class="toc-content svelte-cz3h3s"></div>'),Lt=p(`<button aria-label="Table of Contents" id="mobile-toc-switch" class="btn-plain scale-animation rounded-lg h-11 w-11 active:scale-90 lg:!hidden theme-switch-btn"><!></button> <div id="mobile-toc-panel" class="float-panel float-panel-closed mobile-toc-panel absolute md:w-[20rem] w-[calc(100vw-2rem)]
		top-20 left-4 md:left-[unset] right-4 shadow-2xl rounded-2xl p-4 svelte-cz3h3s"><div class="flex items-center justify-between mb-4"><h3 class="text-lg font-bold text-[var(--primary)]"> </h3> <button aria-label="Close TOC" class="btn-plain rounded-lg h-8 w-8 active:scale-90 theme-switch-btn"><!></button></div> <!></div>`,1);function Ft(X,Z){gt(Z,!1);let S=E([]),z=E([]),y=E(""),h,I=E(!1),k=!1;const K=async()=>{await W.togglePanel("mobile-toc-panel")},R=async t=>{await W.togglePanel("mobile-toc-panel",t)},$=()=>{const t=document.querySelectorAll("h1, h2, h3, h4, h5, h6"),e=[];t.forEach(s=>{if(s.id){const i=Number.parseInt(s.tagName.charAt(1)),v=(s.textContent||"").replace(/#+\s*$/,"");e.push({id:s.id,text:v,level:i})}}),g(S,e)},tt=()=>{const t=document.querySelectorAll(".card-base"),e=[];t.forEach(s=>{const i=s.querySelector('a[href*="/posts/"].transition.group'),v=s.querySelector('a[href*="/categories/"].link-lg'),a=i?.querySelector('svg[data-icon="mdi:pin"]');if(i){const n=i.getAttribute("href"),f=i.textContent?.replace(/\s+/g," ").trim()||"",r=v?.textContent?.trim()||"",c=!!a;n&&f&&e.push({title:f,url:n,category:r,pinned:c})}}),g(z,e)},et=()=>{g(I,window.location.pathname==="/"||window.location.pathname==="")},ot=t=>{const e=document.getElementById(t);if(e){R(!1);const i=e.offsetTop-80;window.scrollTo({top:i,behavior:"smooth"})}},st=t=>{R(!1),yt(t)},q=()=>{const t=document.querySelectorAll("h1, h2, h3, h4, h5, h6"),e=window.scrollY,s=100;let i="";t.forEach(v=>{if(v.id){const a=v.offsetTop-s;e>=a&&(i=v.id)}}),g(y,i)},at=()=>{const t=document.querySelectorAll("h1, h2, h3, h4, h5, h6");h&&h.disconnect(),h=new IntersectionObserver(e=>{e.forEach(s=>{s.isIntersecting&&g(y,s.target.id)})},{rootMargin:"-80px 0px -80% 0px",threshold:0}),t.forEach(e=>{e.id&&h.observe(e)})},nt=()=>{if(typeof window<"u"&&(k=!!window.swup,!k)){const t=()=>{window.swup&&(k=!0,document.removeEventListener("swup:enable",t))};document.addEventListener("swup:enable",t),setTimeout(()=>{window.swup&&(k=!0,document.removeEventListener("swup:enable",t))},1e3)}},V=()=>{et(),nt(),o(I)?tt():($(),at(),q())};ht(()=>(setTimeout(V,100),window.addEventListener("scroll",q),()=>{h&&h.disconnect(),window.removeEventListener("scroll",q)})),typeof window<"u"&&(window.mobileTOCInit=V),bt();var Y=Lt(),T=B(Y),it=d(T);L(it,{icon:"material-symbols:format-list-bulleted",class:"text-[1.25rem]"}),l(T);var D=_(T,2),O=d(D),H=d(O),rt=d(H,!0);l(H);var M=_(H,2),lt=d(M);L(lt,{icon:"material-symbols:close",class:"text-[1rem]"}),l(M),l(O);var ct=_(O,2);{var vt=t=>{var e=F(),s=B(e);{var i=a=>{var n=It(),f=d(n);L(f,{icon:"material-symbols:article-outline",class:"text-2xl mb-2"}),_t(2),l(n),m(a,n)},v=a=>{var n=Ct();G(n,5,()=>o(z),J,(f,r)=>{var c=Tt(),b=d(c),w=d(b);{var N=u=>{L(u,{icon:"mdi:pin",class:"pinned-icon"})};x(w,u=>{o(r).pinned&&u(N)})}var mt=_(w);l(b);var ft=_(b,2);{var pt=u=>{var j=kt(),ut=d(j,!0);l(j),C(()=>P(ut,o(r).category)),m(u,j)};x(ft,u=>{o(r).category&&u(pt)})}l(c),C(()=>P(mt,` ${o(r).title??""}`)),A("click",c,()=>st(o(r).url)),m(f,c)}),l(n),m(a,n)};x(s,a=>{o(z).length===0?a(i):a(v,!1)})}m(t,e)},dt=t=>{var e=F(),s=B(e);{var i=a=>{var n=Et();m(a,n)},v=a=>{var n=At();G(n,5,()=>o(S),J,(f,r)=>{var c=Pt();let b;var w=d(c),N=d(w,!0);l(w),l(c),C(()=>{b=xt(c,1,`toc-item level-${o(r).level??""} ${o(y)===o(r).id?"active":""}`,"svelte-cz3h3s",b,{active:o(y)===o(r).id}),P(N,o(r).text)}),A("click",c,()=>ot(o(r).id)),m(f,c)}),l(n),m(a,n)};x(s,a=>{o(S).length===0?a(i):a(v,!1)})}m(t,e)};x(ct,t=>{o(I)?t(vt):t(dt,!1)})}l(D),C(t=>P(rt,t),[()=>o(I)?U(Q.postList):U(Q.tableOfContents)]),A("click",T,K),A("click",M,K),m(X,Y),wt()}export{Ft as default};
